function [V, phi, th] = model_4(x)

x1 = x(:,1);
x2 = x(:,2);
x3 = x(:,3);
x4 = x(:,4);
x5 = x(:,5);
x6 = x(:,6);
x7 = x(:,7);
x8 = x(:,8);
x9 = x(:,9);
x10 = x(:,10);
x11 = x(:,11);
x12 = x(:,12);
x13 = x(:,13);
x14 = x(:,14);
x15 = x(:,15);
x16 = x(:,16);
x17 = x(:,17);
x18 = x(:,18);
x19 = x(:,19);
x20 = x(:,20);
x21 = x(:,21);
x22 = x(:,22);
x23 = x(:,23);
x24 = x(:,24);

phi = [ ( (((x1*1.22474487 * 1.0 + x2*0.70710678 * 1.0 + x3*-5.66871855 * 1.0 + x4*13.01119703 * 1.0 + x5*-8.36960438 * 1.67262451 + x6*13.01119703 * 1.0 + x7*8.7831853 * 1.27564804 + x8*-6.4260018 * 1.37069858 + x9*0.31830989 * 1.0 + x10*26.34070394 * 0.95600582 + x11*-3.14159265 * 1.03624922 + x12*8.7831853 * 1.0 + x13*-2.52055839 * 1.0 + x14*-1.91684778 * 1.0 + x15*-3.14159265 * 1.0 + x16*0.63661977 * 1.0 + x17*3.14159265 * 1.63087298 + x18*0.25 * 1.0 + x19*3.14159265 * 1.0 + x20*-3.14159265 * 1.0 + x21*6.60149519 * 1.0 + x22*-1.36842366 * 0.95314893 + x23*-3.14159265 * 1.53332716 + x24*-1.59853789 * 1.0 + 10.72606823 * 1.17131322)) .*  ( (((x17*1.0 * 1.0)) .* ((x1*1.22474487 * 1.0 + x2*0.70710678 * 1.0 + x3*-5.66871855 * 1.0 + x4*13.01119703 * 1.0 + x5*-8.36960438 * 1.67262451 + x6*13.01119703 * 1.0 + x7*8.7831853 * 1.27564804 + x8*-6.4260018 * 1.37069858 + x9*0.31830989 * 1.0 + x10*26.34070394 * 0.95600582 + x11*-3.14159265 * 1.03624922 + x12*8.7831853 * 1.0 + x13*-2.52055839 * 1.0 + x14*-1.91684778 * 1.0 + x15*-3.14159265 * 1.0 + x16*0.63661977 * 1.0 + x17*3.14159265 * 1.63087298 + x18*0.25 * 1.0 + x19*3.14159265 * 1.0 + x20*-3.14159265 * 1.0 + x21*6.60149519 * 1.0 + x22*-1.36842366 * 0.95314893 + x23*-3.14159265 * 1.53332716 + x24*-1.59853789 * 1.0 + 10.72606823 * 1.17131322)))  .*  power(((x9*1.0 * 1.0)), 2) ) ) ) , ...
        ( power( (((x1*1.22474487 * 1.0 + x2*0.70710678 * 1.0 + x3*-5.66871855 * 1.0 + x4*13.01119703 * 1.0 + x5*-8.36960438 * 1.67262451 + x6*13.01119703 * 1.0 + x7*8.7831853 * 1.27564804 + x8*-6.4260018 * 1.37069858 + x9*0.31830989 * 1.0 + x10*26.34070394 * 0.95600582 + x11*-3.14159265 * 1.03624922 + x12*8.7831853 * 1.0 + x13*-2.52055839 * 1.0 + x14*-1.91684778 * 1.0 + x15*-3.14159265 * 1.0 + x16*0.63661977 * 1.0 + x17*3.14159265 * 1.63087298 + x18*0.25 * 1.0 + x19*3.14159265 * 1.0 + x20*-3.14159265 * 1.0 + x21*6.60149519 * 1.0 + x22*-1.36842366 * 0.95314893 + x23*-3.14159265 * 1.53332716 + x24*-1.59853789 * 1.0 + 10.72606823 * 1.17131322)) .* ((x4*1.0 * 1.0))) , 2) ) , ...
        ( power( cos(((x5*1.0 * 1.0))) , 2) ) , ...
        ( ( ( sin(((x2*1.0 * 1.0)))  - 1.33333333)  .*  ( sin( sin(((x2*173.37312819 * 1.0 + x3*2.0 * 1.0 + x4*-1.34115831 * 0.86863001 + x5*-4.80207719 * 1.0 + x6*-2.0 * 1.0 + x7*9.86960438 * 1.0 + x8*-0.26084492 * 0.75104756 + x9*2.03509033 * 1.0 + x11*2.03509033 * 0.3389266 + x12*-2.03509033 * 1.0 + x13*8.7831853 * 1.0 + x14*-4.07018066 * 1.0 + x15*17.15278968 * 1.0 + x16*-2.0 * 0.88391988 + x17*-4.80207719 * 1.0 + x18*17.15278968 * 1.0 + x19*3.14159265 * 1.0 + x20*0.65328148 * 1.0 + x21*26.34070394 * 1.0 + x22*-0.31830989 * 1.0 + x23*0.63661977 * 1.0 + x24*-3.14159265 * 1.00708557 + 11.70156151 * 1.0))) )  +  ( (((x2*0.5 * 1.0 + x3*-0.5 * 2.75228321 + x4*9.86960438 * 1.0 + x5*9.86960438 * 1.0 + x6*-0.70710678 * 1.0 + x7*9.86960438 * 1.0 + x8*-9.86960438 * 1.0 + x9*-2.0 * 0.92589884 + x10*-3.14159265 * 1.0 + x11*8.36960438 * 1.0 + x12*-5.66871855 * 1.0 + x13*-2.03509033 * 1.0 + x14*3.14159265 * 1.0 + x15*0.25 * 1.0 + x16*2.03509033 * 1.0 + x17*-2.0 * 1.0 + x18*0.63661977 * 1.0 + x19*-6.4260018 * 1.0 + x20*3.14159265 * 1.0 + x21*0.31830989 * 1.0 + x22*0.84344336 * 1.0 + x23*0.93172555 * 1.0 + 6.60149519 * 1.08430889)) - -9.86960438)  -  sin(((x1*3.14159265 * 1.0 + x2*-4.80207719 * 1.06697517 + x3*1.22474487 * 1.0 + x4*4.14159265 * 1.0 + x5*-3.14159265 * 1.0 + x6*1.5 * 1.02136741 + x7*0.65328148 * 1.0 + x8*0.70710678 * 0.7058523 + x9*0.56418958 * 1.44464114 + x10*-4.07018066 * 1.0 + x11*-2.03509033 * 1.0 + x12*-0.31830989 * 1.0 + x14*0.91666667 * 1.0 + x15*0.31830989 * 1.0 + x16*1.0 * 1.0 + x17*3.14159265 * 1.0 + x18*3.14159265 * 1.0 + x19*-0.22707119 * 1.0 + x20*9.86960438 * 1.0 + x21*0.4267767 * 1.0 + x22*3.14159265 * 1.0 + x23*11.70156151 * 1.0 + x24*8.7831853 * 1.0 + 8.68678413 * 1.0))) ) ) ) ) , ...
        ( (((x2*0.5 * 1.0 + x3*-0.5 * 2.75228321 + x4*9.86960438 * 1.0 + x5*9.86960438 * 1.0 + x6*-0.70710678 * 1.0 + x7*9.86960438 * 1.0 + x8*-9.86960438 * 1.0 + x9*-2.0 * 0.92589884 + x10*-3.14159265 * 1.0 + x11*8.36960438 * 1.0 + x12*-5.66871855 * 1.0 + x13*-2.03509033 * 1.0 + x14*3.14159265 * 1.0 + x15*0.25 * 1.0 + x16*2.03509033 * 1.0 + x17*-2.0 * 1.0 + x18*0.63661977 * 1.0 + x19*-6.4260018 * 1.0 + x20*3.14159265 * 1.0 + x21*0.31830989 * 1.0 + x22*0.84344336 * 1.0 + x23*0.93172555 * 1.0 + 6.60149519 * 1.08430889)) -  sin( (((x2*0.5 * 1.0 + x3*-0.5 * 2.75228321 + x4*9.86960438 * 1.0 + x5*9.86960438 * 1.0 + x6*-0.70710678 * 1.0 + x7*9.86960438 * 1.0 + x8*-9.86960438 * 1.0 + x9*-2.0 * 0.92589884 + x10*-3.14159265 * 1.0 + x11*8.36960438 * 1.0 + x12*-5.66871855 * 1.0 + x13*-2.03509033 * 1.0 + x14*3.14159265 * 1.0 + x15*0.25 * 1.0 + x16*2.03509033 * 1.0 + x17*-2.0 * 1.0 + x18*0.63661977 * 1.0 + x19*-6.4260018 * 1.0 + x20*3.14159265 * 1.0 + x21*0.31830989 * 1.0 + x22*0.84344336 * 1.0 + x23*0.93172555 * 1.0 + 6.60149519 * 1.08430889)) - -9.86960438) ) ) ) , ...
        ones(length(x1), 1) ];

th = [ 8.583E-5 ; ...
       -7.433E-5 ; ...
       -1.35736013 ; ...
       -0.27949412 ; ...
       -0.42961859 ; ...
       -2.16265093 ];

V = phi * th;

% MSE = 3.9824486982403853

% complexity = 52


% Configuration:
%         seed: 1
%         nbOfRuns: 5
%         dataset: Datasets_18/13_Left_Hip_Omega_1000_18.txt
%         maxGenerations: 30000
% Default nbOfThreads: 2
%         epochLength: 1000
%         maxEpochs: 30
%         populationSize: 500
%         nbOfTransformedVar: 40
%         lsIterations: 50
% Default maxNodeEvaluations: 9223372036854775807
%         depthLimit: 5
% Default probHeadNode: 0.1
% Default probTransformedVarNode: 0.2
%         useIdentityNodes: true
% Default saveModelsForPython: false
% Default optMisplacementPenalty: 0.0
% Default desiredOptimum: 
%         regressionClass: LeastSquaresFit
% Default maxWeight: 10000.0
% Default minWeight: 1.0E-20
%         populationClass: PartitionedPopulation
%         resultsDir: Results_18/13_Left_Hip_Omega/5_1000_30_5_40/
%         tailFunctionSet: Multiply, Plus, Minus, Cosine, Pow2, Pow3, Sine
%         solverName: SolverMultiThreaded
%         nbRegressors: 5
%         nbPredictors: 5
% Default improvementThreshold: 0.0
% Default maxNonImprovingEpochs: 2147483647
% Default identityNodeType: identity
