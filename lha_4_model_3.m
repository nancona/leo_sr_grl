function [V, phi, th] = model_3(x)

x1 = x(:,1);
x2 = x(:,2);
x3 = x(:,3);
x4 = x(:,4);
x5 = x(:,5);
x6 = x(:,6);
x7 = x(:,7);
x8 = x(:,8);
x9 = x(:,9);
x10 = x(:,10);
x11 = x(:,11);
x12 = x(:,12);
x13 = x(:,13);
x14 = x(:,14);
x15 = x(:,15);
x16 = x(:,16);
x17 = x(:,17);
x18 = x(:,18);
x19 = x(:,19);
x20 = x(:,20);
x21 = x(:,21);
x22 = x(:,22);
x23 = x(:,23);
x24 = x(:,24);

phi = [ (((x1*-0.625 * 1.0 + x2*-0.02332362 * 1.20227027 + x3*357.94768175 * 1.0 + x4*-3.5 * 1.0 + x5*-12.90556288 * 1.0 + x7*-90.37057427 * 1.0 + x8*150.0625 * 1.0 + x9*4.33012702 * 1.03889958 + x10*-6.5 * 1.0 + x11*33.6875 * 1.0 + x12*150.0625 * 1.0 + x13*-3.5 * 0.67339416 + x14*4.33012702 * 1.0 + x15*10.48900613 * 1.0 + x16*28.83012702 * 1.0 + x17*10.25 * 1.66709479 + x18*7.64159265 * 1.0 + x19*45.18870937 * 1.0 + x20*-1.0 * 0.97896298 + x21*0.765625 * 1.0 + x22*2.7436436 * 2.44425653 + x23*-0.6859109 * 1.0 + x24*3.5 * 1.0 + -6.5 * 1.0))) , ...
        ( ( ( cos(((x4*1.0 * 1.0)))  .* ((x1*-24.5 * 0.69773285 + x2*2401.0 * 0.59279052 + x3*150.0625 * 1.0 + x4*24.5 * 1.0 + x5*71.58030202 * 1.0 + x6*-278.6875 * 1.0 + x7*-19.25 * 1.0 + x8*600.25 * 2.20323855 + x9*-3.5 * 1.0 + x10*-803.90625 * 1.17235068 + x11*33.6875 * 2.91783778 + x12*-12.90556288 * 0.74632576 + x13*26.39159265 * 1.0 + x14*357.94768175 * 0.85002325 + x15*-12.25 * 1.0 + x16*52.75511878 * 1.0 + x17*71.58030202 * 1.0 + x18*-3.5 * 1.45044192 + x19*0.09411292 * 1.68603578 + x20*0.80966838 * 1.0 + x21*-28.83012702 * 1.0 + x22*7.64159265 * 1.0 + x23*14.25 * 3.01643525 + x24*18.75 * 1.0 + -3.5 * 1.40335973)))  -  power(((x16*1.0 * 1.0)), 3) ) ) , ...
        ( ( ( (((x1*2.22144147 * 1.78974566 + x2*1.5 * 1.0 + x3*150.0625 * 1.0 + x4*46.14355203 * 0.9557787 + x5*1.87082869 * 1.00424327 + x6*-18.75 * 1.0 + x7*71.58030202 * 1.25989212 + x8*-24.5 * 1.0 + x9*150.0625 * 1.0 + x10*-92.37057427 * 1.0 + x11*42.875 * 1.0 + x12*-28.83012702 * 1.0 + x13*19.25 * 0.69206193 + x14*-24.5 * 1.0 + x15*10.25 * 0.76734082 + x16*-4.0 * 0.5489187 + x18*2.0 * 1.0 + x19*18.75 * 1.63681362 + x20*30.25 * 1.0 + x21*-12.25 * 0.56907118 + x22*0.80966838 * 1.0 + x23*-7.64159265 * 1.0 + x24*-5.41421356 * 1.27691554)) .* ((x10*1.0 * 1.0)))  .*  sin(((x11*1.0 * 1.0))) )  +  ( (((x23*1.0 * 1.0)) + ((x11*1.0 * 1.0)))  -  power(((x12*1.0 * 1.0)), 2) ) ) ) , ...
        (((x1*2.0 * 1.0 + x2*-19.25 * 0.62875813 + x3*-19.25 * 0.38305214 + x4*-3.5 * 1.0 + x5*33.6875 * 1.0 + x6*16.75 * 1.0 + x7*28.83012702 * 1.0 + x8*-19.25 * 1.87059365 + x9*18.75 * 1.0 + x10*11.66421356 * 1.0 + x11*-21.94033162 * 1.0 + x12*30.25 * 1.0 + x13*-21.94033162 * 1.37093164 + x14*10.25 * 0.93973327 + x16*28.83012702 * 1.0 + x18*5.72144147 * 1.0 + x20*0.5 * 0.87068969 + x21*-0.6859109 * 1.12006219 + x22*-3.5 * 1.02753652 + x23*0.09411292 * 1.62547211 + x24*-0.65556288 * 1.0))) , ...
        (((x4*1.0 * 1.0))) , ...
        ones(length(x1), 1) ];

th = [ 1.366E-4 ; ...
       -2.604E-5 ; ...
       5.9136E-4 ; ...
       -4.4778E-4 ; ...
       0.94927908 ; ...
       0.0188401 ];

V = phi * th;

% MSE = 0.002141195241063331

% complexity = 39


% Configuration:
%         seed: 1
%         nbOfRuns: 5
%         dataset: Datasets_18/4_Left_Hip_Angle_1000_18.txt
%         maxGenerations: 30000
% Default nbOfThreads: 2
%         epochLength: 1000
%         maxEpochs: 30
%         populationSize: 500
%         nbOfTransformedVar: 40
%         lsIterations: 50
% Default maxNodeEvaluations: 9223372036854775807
%         depthLimit: 5
% Default probHeadNode: 0.1
% Default probTransformedVarNode: 0.2
%         useIdentityNodes: true
% Default saveModelsForPython: false
% Default optMisplacementPenalty: 0.0
% Default desiredOptimum: 
%         regressionClass: LeastSquaresFit
% Default maxWeight: 10000.0
% Default minWeight: 1.0E-20
%         populationClass: PartitionedPopulation
%         resultsDir: Results_18/4_Left_Hip_Angle/5_1000_30_5_40/
%         tailFunctionSet: Multiply, Plus, Minus, Cosine, Pow2, Pow3, Sine
%         solverName: SolverMultiThreaded
%         nbRegressors: 5
%         nbPredictors: 5
% Default improvementThreshold: 0.0
% Default maxNonImprovingEpochs: 2147483647
% Default identityNodeType: identity
