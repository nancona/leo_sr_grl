function [V, phi, th] = model_4(x)

x1 = x(:,1);
x2 = x(:,2);
x3 = x(:,3);
x4 = x(:,4);
x5 = x(:,5);
x6 = x(:,6);
x7 = x(:,7);
x8 = x(:,8);
x9 = x(:,9);
x10 = x(:,10);
x11 = x(:,11);
x12 = x(:,12);
x13 = x(:,13);
x14 = x(:,14);
x15 = x(:,15);
x16 = x(:,16);
x17 = x(:,17);
x18 = x(:,18);
x19 = x(:,19);
x20 = x(:,20);
x21 = x(:,21);
x22 = x(:,22);
x23 = x(:,23);
x24 = x(:,24);

phi = [ ( ( (((x1*-9.68476295 * 0.79243148 + x2*4.0 * 1.0 + x3*1.0 * 0.44159578 + x4*17.15278968 * 1.0 + x5*-1.14159265 * 0.60778988 + x6*0.11349982 * 1.34954497 + x7*0.40528474 * 0.55012199 + x8*-1.14159265 * 1.0 + x9*2.0 * 1.37845479 + x10*7.17979007 * 0.35910182 + x11*-2.0 * 1.0 + x12*2.03509033 * 0.85122751 + x13*-3.30855897 * 1.0 + x14*3.14159265 * 0.54709061 + x15*-2.0 * 1.41527222 + x16*7.17979007 * 1.0 + x17*-2.0 * 1.09173469 + x18*2.50662827 * 1.0 + x20*0.11349982 * 1.88082474 + x21*1.0 * 1.0 + x22*2.74219711 * 0.39140943 + x23*0.11349982 * 1.21732367 + x24*-2.50497288 * 1.31911415)) -  ( cos(((x1*-2.0 * 1.0 + x2*1.57079633 * 1.07363252 + x3*0.25 * 0.74950835 + x4*2.73020263 * 1.0 + x6*4.14159265 * 1.0 + x7*0.39691672 * 0.09475601 + x8*-2.46740109 * 0.04450855 + x9*-1.57079633 * 1.0 + x10*-2.46740109 * 1.10653179 + x11*-1.10805616 * 1.0 + x12*3.11203518 * 1.0 + x13*3.0 * 0.88067924 + x14*2.73020263 * 0.41534313 + x16*-1.57079633 * 1.88640965 + x19*1.0 * 0.82755117 + x20*1.0 * 1.59118862 + x21*0.5 * 1.46090561 + x22*2.0 * 0.83239941 + x23*3.11203518 * 0.43871399 + x24*-2.46740109 * 1.0 + 3.14159265 * 1.11735853)))  +  cos(((x1*-2.0 * 1.0 + x2*1.57079633 * 1.07363252 + x3*0.25 * 0.74950835 + x4*2.73020263 * 1.0 + x6*4.14159265 * 1.0 + x7*0.39691672 * 0.09475601 + x8*-2.46740109 * 0.04450855 + x9*-1.57079633 * 1.0 + x10*-2.46740109 * 1.10653179 + x11*-1.10805616 * 1.0 + x12*3.11203518 * 1.0 + x13*3.0 * 0.88067924 + x14*2.73020263 * 0.41534313 + x16*-1.57079633 * 1.88640965 + x19*1.0 * 0.82755117 + x20*1.0 * 1.59118862 + x21*0.5 * 1.46090561 + x22*2.0 * 0.83239941 + x23*3.11203518 * 0.43871399 + x24*-2.46740109 * 1.0 + 3.14159265 * 1.11735853))) ) )  - ((x1*0.70710678 * 2.23314771 + x2*-17.15278968 * 0.34999415 + x3*-2.0 * 1.27266759 + x4*-0.48057978 * 1.42010389 + x5*2.57079632 * 1.69149837 + x6*1.41421356 * 1.0 + x7*0.40528474 * 1.0 + x8*9.97299961 * 1.0 + x10*-0.53959474 * 1.21195853 + x11*2.67951303 * 1.0 + x12*-3.30855897 * 1.0 + x13*-5.03884045 * 1.08367149 + x14*17.15278968 * 1.0 + x15*-1.57079633 * 0.87062128 + x17*0.39691672 * 0.89434641 + x18*1.41421356 * 2.05349649 + x19*1.58271061 * 1.0 + x20*0.11349982 * 1.0 + x21*2.50497288 * 1.72462075 + x22*17.15278968 * 1.0 + x23*4.14159265 * 0.91712683 + x24*-0.33689734 * 0.6961324 + 2.0 * -0.12044817))) ) , ...
        ( sin( (0.00146213 .*  (((x2*-17.15278968 * 1.0 + x3*17.15278968 * 1.01092521 + x4*-2.0 * 1.0 + x5*5.60899374 * 1.0 + x6*-5.03884045 * 0.94283376 + x7*1.0 * 1.0 + x8*7.17979007 * 1.0 + x9*0.70710678 * 0.80975149 + x10*2.0 * 0.82629336 + x11*-5.60899374 * 1.33750982 + x12*-2.46740109 * 1.0 + x13*0.40528474 * 0.37110483 + x14*2.0 * 1.01165113 + x16*0.84089642 * 1.0 + x17*1.0 * 1.0 + x18*-1.0 * 1.0 + x19*-0.53959474 * 1.0 + x20*-2.0 * 1.0 + x21*0.01288221 * 1.0 + x23*-0.70710678 * 1.0 + x24*2.57079632 * 1.0 + -3.30855897 * 2.06229983)) .* ((x18*1.0 * 1.0))) ) ) ) , ...
        ( power( (((x20*1.0 * 1.0)) - ((x1*-0.33689734 * 1.0 + x2*9.97299961 * 1.0 + x3*4.14159265 * 1.0 + x4*3.78940367 * 1.0 + x5*1.57079633 * 1.0 + x6*3.14159265 * 1.35530472 + x7*-3.89764111 * 1.0 + x8*1.0 * 1.58238001 + x9*-9.68476295 * 1.0 + x10*4.14159265 * 1.0 + x12*-2.46740109 * 1.0470709 + x13*0.5 * 1.0 + x14*0.51942022 * 1.0 + x15*1.0 * 1.0 + x16*0.57079632 * 1.0 + x17*2.50497288 * 1.19435407 + x18*3.0 * 1.0 + x19*0.84089642 * 1.0 + x21*1.0 * 1.03250631 + x23*-1.14159265 * 1.0 + x24*0.40528474 * 1.0 + -5.60899374 * 2.00103822))) , 3) ) , ...
        ( ( (-0.60308328 -  ( cos(((x9*1.0 * 1.0)))  - 1.0) )  .*  ( ( sin(((x1*-2.67951303 * -0.02949737 + x2*-1.0 * 1.0 + x3*2.0 * 0.46107967 + x4*0.29289322 * 1.0 + x5*0.40528474 * 0.26530518 + x6*0.63661977 * 1.0 + x7*2.50662827 * 1.0 + x8*0.63661977 * 1.56144583 + x9*5.60899374 * 0.99314782 + x10*1.57079633 * 1.30495433 + x11*0.40528474 * 1.0 + x12*-3.30855897 * 1.0 + x13*1.58271061 * 1.0 + x14*-0.48057978 * 1.0 + x15*2.82842712 * 0.92624265 + x16*0.51942022 * 1.0 + x17*4.14159265 * 1.0 + x18*-1.0 * 0.94666215 + x19*2.51942022 * 1.0 + x20*2.50497288 * 1.0 + x21*-1.50497288 * 1.0 + x22*1.0 * 1.1083279 + x23*1.0 * 1.45270614 + x24*0.5 * 1.0 + 0.40528474 * 0.90976355)))  .* 1.11951513)  +  ( (((x1*-0.33689734 * 1.0 + x2*9.97299961 * 1.0 + x3*4.14159265 * 1.0 + x4*3.78940367 * 1.0 + x5*1.57079633 * 1.0 + x6*3.14159265 * 1.35530472 + x7*-3.89764111 * 1.0 + x8*1.0 * 1.58238001 + x9*-9.68476295 * 1.0 + x10*4.14159265 * 1.0 + x12*-2.46740109 * 1.0470709 + x13*0.5 * 1.0 + x14*0.51942022 * 1.0 + x15*1.0 * 1.0 + x16*0.57079632 * 1.0 + x17*2.50497288 * 1.19435407 + x18*3.0 * 1.0 + x19*0.84089642 * 1.0 + x21*1.0 * 1.03250631 + x23*-1.14159265 * 1.0 + x24*0.40528474 * 1.0 + -5.60899374 * 2.00103822)) .* 0.70710678)  +  sin(((x15*1.0 * 1.0))) ) ) ) ) , ...
        ( ( ( (9.97299961 + ((x8*1.0 * 1.0)))  .*  sin(((x9*1.0 * 1.0))) )  .*  cos( (((x21*1.0 * 1.0)) .* ((x2*1.0 * 1.0))) ) ) ) , ...
        ones(length(x1), 1) ];

th = [ 3.3847E-4 ; ...
       -0.2981904 ; ...
       9.9E-7 ; ...
       -0.01954315 ; ...
       0.0928279 ; ...
       0.08569921 ];

V = phi * th;

% MSE = 0.0049677750051956805

% complexity = 64


% Configuration:
%         seed: 1
%         nbOfRuns: 5
%         dataset: Datasets_18/9_Right_Ankle_Angle_1000_18.txt
%         maxGenerations: 30000
% Default nbOfThreads: 2
%         epochLength: 1000
%         maxEpochs: 30
%         populationSize: 500
%         nbOfTransformedVar: 40
%         lsIterations: 50
% Default maxNodeEvaluations: 9223372036854775807
%         depthLimit: 5
% Default probHeadNode: 0.1
% Default probTransformedVarNode: 0.2
%         useIdentityNodes: true
% Default saveModelsForPython: false
% Default optMisplacementPenalty: 0.0
% Default desiredOptimum: 
%         regressionClass: LeastSquaresFit
% Default maxWeight: 10000.0
% Default minWeight: 1.0E-20
%         populationClass: PartitionedPopulation
%         resultsDir: Results_18/9_Right_Ankle_Angle/5_1000_30_5_40/
%         tailFunctionSet: Multiply, Plus, Minus, Cosine, Pow2, Pow3, Sine
%         solverName: SolverMultiThreaded
%         nbRegressors: 5
%         nbPredictors: 5
% Default improvementThreshold: 0.0
% Default maxNonImprovingEpochs: 2147483647
% Default identityNodeType: identity
